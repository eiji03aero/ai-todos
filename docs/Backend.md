# Backend Development Guidelines

## 技術スタック

### 言語: Golang
- バージョン: 最新の安定版 (1.22以降を推奨)
- 特徴:
  - 高パフォーマンス
  - 静的型付け
  - 並行処理のサポート
  - コンパイル時の型安全性

### HTTPサーバーフレームワーク: Gin
- 選定理由:
  - 高速なルーティング
  - 軽量で柔軟
  - ミドルウェアのサポート
  - 優れたパフォーマンス

### ORM: Gorm
- 選定理由:
  - 豊富な機能セット
  - データベース抽象化
  - マイグレーションサポート
  - 複雑なクエリの簡単な実装

## オニオンアーキテクチャ

### フォルダ構成

```
backend/
│
├── cmd/                  # アプリケーションのエントリーポイント
│   └── server/
│       └── main.go
│
├── internal/             # 内部パッケージ (外部から参照不可)
│   ├── domain/           # ドメインモデルとビジネスロジック
│   │   ├── models/       # エンティティ定義
│   │   └── interfaces/   # インターフェース定義
│   │
│   ├── infrastructure/   # 外部との接続実装
│   │   ├── database/     # データベース接続
│   │   ├── repositories/ # データアクセス層
│   │   └── api/          # 外部API接続
│   │
│   ├── application/      # アプリケーションサービス
│   │   ├── services/     # ユースケース実装
│   │   └── dto/          # データ転送オブジェクト
│   │
│   └── presentation/     # HTTPハンドラー
│       ├── handlers/     # リクエスト処理
│       └── middleware/   # 共通ミドルウェア
│
├── pkg/                  # 外部から利用可能な共通パッケージ
│   └── utils/            # 汎用ユーティリティ
│
├── configs/              # 設定ファイル
│
└── migrations/           # データベースマイグレーション
```

### アーキテクチャの利点
- 関心の分離
- テスタビリティの向上
- モジュール性
- 依存関係の明確な制御

## 開発ガイドライン

1. **依存性の方向**
   - 内側の層は外側の層に依存してはいけない
   - ドメイン層は最も内側に配置し、他の層から独立

2. **インターフェース駆動開発**
   - 具象実装よりもインターフェースに依存
   - 依存性逆転の原則を遵守

3. **エラーハンドリング**
   - カスタムエラー型の活用
   - エラーのラッピングと詳細な情報提供

4. **セキュリティ**
   - 入力バリデーション
   - 適切な認証・認可メカニズム
   - 安全なデータベース操作

## 推奨ツール・ライブラリ

- テスティング: testify
- ロギング: zap
- 設定管理: viper
- バリデーション: validator
- 依存性注入: wire

## パフォーマンスと最適化

- コネクションプーリング
- キャッシュ戦略
- インデックスの適切な設計
- クエリの最適化

## 継続的な改善

- コードレビュー
- 定期的なリファクタリング
- パフォーマンスプロファイリング
- セキュリティ監査